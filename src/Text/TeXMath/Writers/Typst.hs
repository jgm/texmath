{-# LANGUAGE GeneralizedNewtypeDeriving, ViewPatterns, GADTs, OverloadedStrings #-}
{-
Copyright (C) 2023 John MacFarlane <jgm@berkeley.edu>

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

-}

module Text.TeXMath.Writers.Typst (writeTypst) where

import Data.List (transpose)
import Data.Maybe (fromMaybe)
import qualified Data.Map as M
import qualified Data.Text as T
import Text.TeXMath.Types
import qualified Text.TeXMath.Shared as S
import Data.Generics (everywhere, mkT)
import Data.Text (Text)

-- import Debug.Trace
-- tr' x = trace (show x) x

-- | Transforms an expression tree to equivalent Typst
writeTypst :: DisplayType -> [Exp] -> Text
writeTypst dt exprs =
  T.unwords $ map writeExp $ everywhere (mkT $ S.handleDownup dt) exprs

writeExps :: [Exp] -> Text
writeExps = T.intercalate " " . map writeExp

inParens :: Text -> Text
inParens s = "(" <> s <> ")"

inQuotes :: Text -> Text
inQuotes s = "\"" <> s <> "\""

writeExp' :: Exp -> Text
writeExp' (EGrouped es) = "(" <> writeExps es <> ")"
writeExp' e = writeExp e

writeExp :: Exp -> Text
writeExp (ENumber s) = s
writeExp (ESymbol _t s) =
  fromMaybe s $ M.lookup s typstSymbols
writeExp (EIdentifier s) =
  writeExp (ESymbol Ord s)
writeExp (EMathOperator s)
  | s `elem` ["arccos", "arcsin", "arctan", "arg", "cos", "cosh",
              "cot", "ctg", "coth", "csc", "deg", "det", "dim", "exp",
              "gcd", "hom", "mod", "inf", "ker", "lg", "lim", "ln",
              "log", "max", "min", "Pr", "sec", "sin", "sinh", "sup",
              "tan", "tg", "tanh", "liminf", "and", "limsup"]
    = s
  | otherwise = "\"" <> s <> "\""
writeExp (EGrouped es) = writeExps es
writeExp (EFraction _fractype e1 e2) =
  case (e1, e2) of
    (EGrouped _, _) -> "frac(" <> writeExp e1 <> ", " <> writeExp e2 <> ")"
    (_, EGrouped _) -> "frac(" <> writeExp e1 <> ", " <> writeExp e2 <> ")"
    _ -> writeExp e1 <> " / " <> writeExp e2
writeExp (ESub b e1) = writeExp' b <> "_" <> writeExp' e1
writeExp (ESuper b e1) = writeExp' b <> "^" <> writeExp' e1
writeExp (ESubsup b e1 e2) = writeExp' b <> "_" <> writeExp' e1 <>
                                            "^" <> writeExp' e2
writeExp (EOver _convertible b e1) =
  case e1 of
    ESymbol Accent "`" -> "grave" <> inParens (writeExp b)
    ESymbol Accent "¬¥" -> "acute" <> inParens (writeExp b)
    ESymbol Accent "^" -> "hat" <> inParens (writeExp b)
    ESymbol Accent "~" -> "tilde" <> inParens (writeExp b)
    ESymbol Accent "¬Ø" -> "macron" <> inParens (writeExp b)
    ESymbol Accent "Àò" -> "breve" <> inParens (writeExp b)
    ESymbol Accent "." -> "dot" <> inParens (writeExp b)
    ESymbol Accent "¬®" -> "diaer" <> inParens (writeExp b)
    ESymbol Accent "‚àò" -> "circle" <> inParens (writeExp b)
    ESymbol Accent "Àù" -> "acute.double" <> inParens (writeExp b)
    ESymbol Accent "Àá" -> "caron" <> inParens (writeExp b)
    ESymbol Accent "‚Üí" -> "->" <> inParens (writeExp b)
    ESymbol Accent "‚Üê" -> "<-" <> inParens (writeExp b)
    ESymbol TOver "\9182" -> "overbrace(" <> writeExp b <> ")"
    ESymbol TOver "\9140" -> "overbracket(" <> writeExp b <> ")"
    _ -> writeExp' b <> "^" <> writeExp' e1
writeExp (EUnder _convertible b e1) =
  case e1 of
    ESymbol TUnder "\9182" -> "underbrace(" <> writeExp b <> ")"
    ESymbol TUnder "\9140" -> "underbracket(" <> writeExp b <> ")"
    _ -> writeExp' b <> "_" <> writeExp' e1
writeExp (EUnderover convertible b e1 e2) =
  case (e1, e2) of
    (_, ESymbol Accent _) -> writeExp (EUnder convertible (EOver False b e2) e1)
    (_, ESymbol TOver _) -> writeExp (EUnder convertible (EOver False b e2) e1)
    (ESymbol TUnder _, _) -> writeExp (EOver convertible (EUnder False b e1) e2)
    _ -> writeExp' b <> "_" <> writeExp' e1 <> "^" <> writeExp' e2
writeExp (ESqrt e) = "sqrt(" <> writeExp e <> ")"
writeExp (ERoot i e) = "root(" <> writeExp i <> ", " <> writeExp e <> ")"
writeExp (ESpace width) =
  case (floor (width * 18) :: Int) of
    0 -> "space.nws"
    3 -> "space.thin"
    4 -> "space.med"
    6 -> "space.thick"
    18 -> "space.quad"
    n -> "h(" <> tshow (n `div` 18) <> "em)"
writeExp (EText ttype s) =
  case ttype of
       TextNormal -> "upright(" <> inQuotes s <> ")"
       TextItalic -> "italic(" <> inQuotes s <> ")"
       TextBold   -> "bold(" <> inQuotes s <> ")"
       TextBoldItalic -> "bold(italic(" <> inQuotes s <> "))"
       _   -> inQuotes s
writeExp (EStyled ttype es) =
  let contents = writeExps es
  in case ttype of
       TextNormal -> "upright(" <> contents <> ")"
       TextItalic -> "italic(" <> contents <> ")"
       TextBold   -> "bold(" <> contents <> ")"
       TextBoldItalic -> "bold(italic(" <> contents <> "))"
       _   -> contents
writeExp (EBoxed e) = "box(" <> writeExp e <> ")"
writeExp (EPhantom e) = "hide[" <> writeExp e <> "]" -- TODO check
writeExp (EScaled size e) =
  "scale(x=" <> tshow size <> ",y=" <> tshow size <> ")[" <> writeExp e <> "]"
writeExp (EDelimited "(" ")" [Right (EArray _aligns rows)])
  | all (\row -> length row == 1) rows = -- vector
  "vec(" <> mkArray (transpose rows) <> ")"
writeExp (EDelimited "(" ")" [Right (EArray _aligns [[xs],[ys]])]) =
  "binom(" <> writeExps xs <> ", " <> writeExps ys <> ")"
writeExp (EDelimited "(" ")" [Right (EArray _aligns rows)]) =
  "mat(delim: \"(\", " <> mkArray rows <> ")"
writeExp (EDelimited "[" "]" [Right (EArray _aligns rows)]) =
  "mat(delim: \"[\", " <> mkArray rows <> ")"
writeExp (EDelimited "{" "}" [Right (EArray _aligns rows)]) =
  "mat(delim: \"{\", " <> mkArray rows <> ")"
writeExp (EDelimited "|" "|" [Right (EArray _aligns rows)]) =
  "mat(delim: \"|\", " <> mkArray rows <> ")"
writeExp (EDelimited "||" "||" [Right (EArray _aligns rows)]) =
  "mat(delim: \"||\", " <> mkArray rows <> ")"
writeExp (EDelimited open close es) =
  "lr(" <> open <> T.intercalate " " (map fromDelimited es) <> close <> ")"
  where fromDelimited (Left e)  = e
        fromDelimited (Right e) = writeExp e
writeExp (EArray _aligns rows)
  = T.intercalate "\\\n" $ map mkRow rows
     where mkRow = T.intercalate " &" . map writeExps

mkArray :: [[[Exp]]] -> Text
mkArray rows =
  T.intercalate "; " $ map mkRow rows
 where
   mkRow = T.intercalate ", " . map mkCell
   mkCell = writeExps

tshow :: Show a => a -> Text
tshow = T.pack . show

typstSymbols :: M.Map Text Text
typstSymbols = M.fromList
  [ ("ùî∏","AA")
  , ("Œë","Alpha")
  , ("ùîπ","BB")
  , ("Œí","Beta")
  , ("‚ÑÇ","CC")
  , ("Œß","Chi")
  , ("ùîª","DD")
  , ("Œî","Delta")
  , ("ùîº","EE")
  , ("Œï","Epsilon")
  , ("Œó","Eta")
  , ("ùîΩ","FF")
  , ("ùîæ","GG")
  , ("Œì","Gamma")
  , ("‚Ñç","HH")
  , ("ùïÄ","II")
  , ("‚Ñë","Im")
  , ("Œô","Iota")
  , ("ùïÅ","JJ")
  , ("ùïÇ","KK")
  , ("œè","Kai")
  , ("Œö","Kappa")
  , ("ùïÉ","LL")
  , ("Œõ","Lambda")
  , ("ùïÑ","MM")
  , ("Œú","Mu")
  , ("‚Ñï","NN")
  , ("Œù","Nu")
  , ("ùïÜ","OO")
  , ("Œ©","Omega")
  , ("Œü","Omicron")
  , ("‚Ñô","PP")
  , ("Œ¶","Phi")
  , ("Œ†","Pi")
  , ("Œ®","Psi")
  , ("‚Ñö","QQ")
  , ("‚Ñù","RR")
  , ("‚Ñú","Re")
  , ("Œ°","Rho")
  , ("ùïä","SS")
  , ("Œ£","Sigma")
  , ("ùïã","TT")
  , ("Œ§","Tau")
  , ("Œò","Theta")
  , ("ùïå","UU")
  , ("Œ•","Upsilon")
  , ("ùïç","VV")
  , ("ùïé","WW")
  , ("ùïè","XX")
  , ("Œû","Xi")
  , ("ùïê","YY")
  , ("‚Ñ§","ZZ")
  , ("Œñ","Zeta")
  , ("¬¥","acute")
  , ("Àù","acute.double")
  , ("◊ê","alef")
  , ("Œ±","alpha")
  , ("&","amp")
  , ("‚Öã","amp.inv")
  , ("‚àß","and")
  , ("‚ãÄ","and.big")
  , ("‚ãè","and.curly")
  , ("‚üë","and.dot")
  , ("‚©ì","and.double")
  , ("‚à†","angle")
  , ("‚å©","angle.l")
  , ("‚å™","angle.r")
  , ("„Ää","angle.l.double")
  , ("„Äã","angle.r.double")
  , ("‚¶ü","angle.acute")
  , ("‚à°","angle.arc")
  , ("‚¶õ","angle.arc.rev")
  , ("‚¶£","angle.rev")
  , ("‚àü","angle.right")
  , ("\11262","angle.right.rev")
  , ("‚äæ","angle.right.arc")
  , ("‚¶ù","angle.right.dot")
  , ("‚¶ú","angle.right.sq")
  , ("‚üÄ","angle.spatial")
  , ("‚à¢","angle.spheric")
  , ("‚¶†","angle.spheric.rev")
  , ("‚¶°","angle.spheric.top")
  , ("‚Ñ´","angstrom")
  , ("‚âà","approx")
  , ("‚âä","approx.eq")
  , ("‚ââ","approx.not")
  , ("‚Üí","arrow.r")
  , ("‚üº","arrow.r.long.bar")
  , ("‚Ü¶","arrow.r.bar")
  , ("‚§∑","arrow.r.curve")
  , ("‚á¢","arrow.r.dashed")
  , ("‚§ë","arrow.r.dotted")
  , ("‚áí","arrow.r.double")
  , ("‚§á","arrow.r.double.bar")
  , ("‚üπ","arrow.r.double.long")
  , ("‚üæ","arrow.r.double.long.bar")
  , ("‚áè","arrow.r.double.not")
  , ("‚û°","arrow.r.filled")
  , ("‚Ü™","arrow.r.hook")
  , ("‚ü∂","arrow.r.long")
  , ("‚üø","arrow.r.long.squiggly")
  , ("‚Ü¨","arrow.r.loop")
  , ("‚Üõ","arrow.r.not")
  , ("‚≠Ü","arrow.r.quad")
  , ("‚áù","arrow.r.squiggly")
  , ("‚á•","arrow.r.stop")
  , ("‚á®","arrow.r.stroked")
  , ("‚Ü£","arrow.r.tail")
  , ("‚áõ","arrow.r.triple")
  , ("‚§Ö","arrow.r.twohead.bar")
  , ("‚Ü†","arrow.r.twohead")
  , ("‚Üù","arrow.r.wave")
  , ("‚Üê","arrow.l")
  , ("‚Ü§","arrow.l.bar")
  , ("‚§∂","arrow.l.curve")
  , ("‚á†","arrow.l.dashed")
  , ("‚¨∏","arrow.l.dotted")
  , ("‚áê","arrow.l.double")
  , ("‚§Ü","arrow.l.double.bar")
  , ("‚ü∏","arrow.l.double.long")
  , ("‚üΩ","arrow.l.double.long.bar")
  , ("‚áç","arrow.l.double.not")
  , ("‚¨Ö","arrow.l.filled")
  , ("‚Ü©","arrow.l.hook")
  , ("‚üµ","arrow.l.long")
  , ("‚üª","arrow.l.long.bar")
  , ("‚¨≥","arrow.l.long.squiggly")
  , ("‚Ü´","arrow.l.loop")
  , ("‚Üö","arrow.l.not")
  , ("‚≠Ö","arrow.l.quad")
  , ("‚áú","arrow.l.squiggly")
  , ("‚á§","arrow.l.stop")
  , ("‚á¶","arrow.l.stroked")
  , ("‚Ü¢","arrow.l.tail")
  , ("‚áö","arrow.l.triple")
  , ("‚¨∂","arrow.l.twohead.bar")
  , ("‚Üû","arrow.l.twohead")
  , ("‚Üú","arrow.l.wave")
  , ("‚Üë","arrow.t")
  , ("‚Ü•","arrow.t.bar")
  , ("‚§¥","arrow.t.curve")
  , ("‚á°","arrow.t.dashed")
  , ("‚áë","arrow.t.double")
  , ("‚¨Ü","arrow.t.filled")
  , ("‚ü∞","arrow.t.quad")
  , ("‚§í","arrow.t.stop")
  , ("‚áß","arrow.t.stroked")
  , ("‚§ä","arrow.t.triple")
  , ("‚Üü","arrow.t.twohead")
  , ("‚Üì","arrow.b")
  , ("‚Üß","arrow.b.bar")
  , ("‚§µ","arrow.b.curve")
  , ("‚á£","arrow.b.dashed")
  , ("‚áì","arrow.b.double")
  , ("‚¨á","arrow.b.filled")
  , ("‚ü±","arrow.b.quad")
  , ("‚§ì","arrow.b.stop")
  , ("‚á©","arrow.b.stroked")
  , ("‚§ã","arrow.b.triple")
  , ("‚Ü°","arrow.b.twohead")
  , ("‚Üî","arrow.l.r")
  , ("‚áî","arrow.l.r.double")
  , ("‚ü∫","arrow.l.r.double.long")
  , ("‚áé","arrow.l.r.double.not")
  , ("‚¨å","arrow.l.r.filled")
  , ("‚ü∑","arrow.l.r.long")
  , ("‚ÜÆ","arrow.l.r.not")
  , ("‚¨Ñ","arrow.l.r.stroked")
  , ("‚Ü≠","arrow.l.r.wave")
  , ("‚Üï","arrow.t.b")
  , ("‚áï","arrow.t.b.double")
  , ("‚¨ç","arrow.t.b.filled")
  , ("‚á≥","arrow.t.b.stroked")
  , ("‚Üó","arrow.tr")
  , ("‚áó","arrow.tr.double")
  , ("‚¨à","arrow.tr.filled")
  , ("‚§§","arrow.tr.hook")
  , ("‚¨Ä","arrow.tr.stroked")
  , ("‚Üò","arrow.br")
  , ("‚áò","arrow.br.double")
  , ("‚¨ä","arrow.br.filled")
  , ("‚§•","arrow.br.hook")
  , ("‚¨Ç","arrow.br.stroked")
  , ("‚Üñ","arrow.tl")
  , ("‚áñ","arrow.tl.double")
  , ("‚¨â","arrow.tl.filled")
  , ("‚§£","arrow.tl.hook")
  , ("‚¨Å","arrow.tl.stroked")
  , ("‚Üô","arrow.bl")
  , ("‚áô","arrow.bl.double")
  , ("‚¨ã","arrow.bl.filled")
  , ("‚§¶","arrow.bl.hook")
  , ("‚¨É","arrow.bl.stroked")
  , ("‚§°","arrow.tl.br")
  , ("‚§¢","arrow.tr.bl")
  , ("‚Ü∫","arrow.ccw")
  , ("‚Ü∂","arrow.ccw.half")
  , ("‚Üª","arrow.cw")
  , ("‚Ü∑","arrow.cw.half")
  , ("‚ÜØ","arrow.zigzag")
  , ("‚åÉ","arrowhead.t")
  , ("‚åÑ","arrowhead.b")
  , ("‚áâ","arrows.rr")
  , ("‚áá","arrows.ll")
  , ("‚áà","arrows.tt")
  , ("‚áä","arrows.bb")
  , ("‚áÜ","arrows.lr")
  , ("‚Üπ","arrows.lr.stop")
  , ("‚áÑ","arrows.rl")
  , ("‚áÖ","arrows.tb")
  , ("‚áµ","arrows.bt")
  , ("‚á∂","arrows.rrr")
  , ("‚¨±","arrows.lll")
  , ("*","ast")
  , ("‚Åé","ast.low")
  , ("‚Åë","ast.double")
  , ("‚ÅÇ","ast.triple")
  , ("Ôπ°","ast.small")
  , ("‚àó","ast.op")
  , ("‚äõ","ast.circle")
  , ("‚ßÜ","ast.sq")
  , ("@","at")
  , ("\\","backslash")
  , ("‚¶∏","backslash.circle")
  , ("‚ß∑","backslash.not")
  , ("‚òê","ballot")
  , ("‚òí","ballot.x")
  , ("|","bar.v")
  , ("‚Äñ","bar.v.double")
  , ("‚¶Ä","bar.v.triple")
  , ("¬¶","bar.v.broken")
  , ("‚¶∂","bar.v.circle")
  , ("‚Äï","bar.h")
  , ("‚àµ","because")
  , ("◊ë","bet")
  , ("Œ≤","beta")
  , ("œê","beta.alt")
  , ("‚Çø","bitcoin")
  , ("‚ä•","bot")
  , ("{","brace.l")
  , ("}","brace.r")
  , ("‚èû","brace.t")
  , ("‚èü","brace.b")
  , ("[","bracket.l")
  , ("]","bracket.r")
  , ("‚é¥","bracket.t")
  , ("‚éµ","bracket.b")
  , ("Àò","breve")
  , ("‚Ä∏","caret")
  , ("Àá","caron")
  , ("‚úì","checkmark")
  , ("üó∏","checkmark.light")
  , ("œá","chi")
  , ("‚óã","circle.stroked")
  , ("‚àò","circle.stroked.tiny")
  , ("‚ö¨","circle.stroked.small")
  , ("‚óØ","circle.stroked.big")
  , ("‚óè","circle.filled")
  , ("‚¶Å","circle.filled.tiny")
  , ("‚àô","circle.filled.small")
  , ("‚¨§","circle.filled.big")
  , ("‚óå","circle.dotted")
  , ("‚äö","circle.nested")
  , ("‚ÑÖ","co")
  , (":","colon")
  , ("‚âî","colon.eq")
  , ("‚©¥","colon.double.eq")
  , (",","comma")
  , ("‚àÅ","complement")
  , ("‚àò","compose")
  , ("‚àó","convolve")
  , ("¬©","copyright")
  , ("‚Ñó","copyright.sound")
  , ("‚Ä†","dagger")
  , ("‚Ä°","dagger.double")
  , ("‚Äì","dash.en")
  , ("‚Äî","dash.em")
  , ("‚Äí","dash.fig")
  , ("„Äú","dash.wave")
  , ("‚àπ","dash.colon")
  , ("‚äù","dash.circle")
  , ("„Ä∞","dash.wave.double")
  , ("¬∞","degree")
  , ("‚ÑÉ","degree.c")
  , ("‚Ñâ","degree.f")
  , ("Œ¥","delta")
  , ("¬®","diaer")
  , ("‚åÄ","diameter")
  , ("‚óá","diamond.stroked")
  , ("‚ãÑ","diamond.stroked.small")
  , ("‚¨¶","diamond.stroked.medium")
  , ("‚üê","diamond.stroked.dot")
  , ("‚óÜ","diamond.filled")
  , ("‚¨•","diamond.filled.medium")
  , ("‚¨©","diamond.filled.small")
  , ("‚àÇ","diff")
  , ("√∑","div")
  , ("‚®∏","div.circle")
  , ("‚à£","divides")
  , ("‚à§","divides.not")
  , ("$","dollar")
  , (".","dot")
  , ("‚ãÖ","dot.op")
  , ("¬∑","dot.c")
  , ("‚äô","dot.circle")
  , ("‚®Ä","dot.circle.big")
  , ("‚ä°","dot.square")
  , ("‚Ä¶","dots.h")
  , ("‚ãØ","dots.h.c")
  , ("‚ãÆ","dots.v")
  , ("‚ã±","dots.down")
  , ("‚ã∞","dots.up")
  , ("‚Ñì","ell")
  , ("‚¨≠","ellipse.stroked.h")
  , ("‚¨Ø","ellipse.stroked.v")
  , ("‚¨¨","ellipse.filled.h")
  , ("‚¨Æ","ellipse.filled.v")
  , ("Œµ","epsilon")
  , ("œµ","epsilon.alt")
  , ("=","eq")
  , ("‚âõ","eq.star")
  , ("‚äú","eq.circle")
  , ("‚âï","eq.colon")
  , ("‚âù","eq.def")
  , ("‚âú","eq.delta")
  , ("‚âö","eq.equi")
  , ("‚âô","eq.est")
  , ("‚ãù","eq.gt")
  , ("‚ãú","eq.lt")
  , ("‚âû","eq.m")
  , ("‚â†","eq.not")
  , ("‚ãû","eq.prec")
  , ("‚âü","eq.quest")
  , ("Ôπ¶","eq.small")
  , ("‚ãü","eq.succ")
  , ("Œ∑","eta")
  , ("‚Ç¨","euro")
  , ("!","excl")
  , ("‚Äº","excl.double")
  , ("¬°","excl.inv")
  , ("‚Åâ","excl.quest")
  , ("‚àÉ","exists")
  , ("‚àÑ","exists.not")
  , ("‚ßò","fence.l")
  , ("‚ßö","fence.l.double")
  , ("‚ßô","fence.r")
  , ("‚ßõ","fence.r.double")
  , ("‚¶ô","fence.dotted")
  , ("‚ù¶","floral")
  , ("‚òô","floral.l")
  , ("‚ùß","floral.r")
  , ("‚àÄ","forall")
  , ("‚Ç£","franc")
  , ("Œ≥","gamma")
  , ("◊í","gimel")
  , ("`","grave")
  , (">","gt")
  , ("‚ßÅ","gt.circle")
  , ("‚ãó","gt.dot")
  , ("‚â´","gt.double")
  , ("‚â•","gt.eq")
  , ("‚ãõ","gt.eq.lt")
  , ("‚â±","gt.eq.not")
  , ("‚âß","gt.eqq")
  , ("‚â∑","gt.lt")
  , ("‚âπ","gt.lt.not")
  , ("‚â©","gt.neqq")
  , ("‚âØ","gt.not")
  , ("‚ãß","gt.ntilde")
  , ("Ôπ•","gt.small")
  , ("‚â≥","gt.tilde")
  , ("‚âµ","gt.tilde.not")
  , ("‚ãô","gt.triple")
  , ("‚´∏","gt.triple.nested")
  , ("‚áÄ","harpoon.rt")
  , ("‚•õ","harpoon.rt.bar")
  , ("‚•ì","harpoon.rt.stop")
  , ("‚áÅ","harpoon.rb")
  , ("‚•ü","harpoon.rb.bar")
  , ("‚•ó","harpoon.rb.stop")
  , ("‚Üº","harpoon.lt")
  , ("‚•ö","harpoon.lt.bar")
  , ("‚•í","harpoon.lt.stop")
  , ("‚ÜΩ","harpoon.lb")
  , ("‚•û","harpoon.lb.bar")
  , ("‚•ñ","harpoon.lb.stop")
  , ("‚Üø","harpoon.tl")
  , ("‚•†","harpoon.tl.bar")
  , ("‚•ò","harpoon.tl.stop")
  , ("‚Üæ","harpoon.tr")
  , ("‚•ú","harpoon.tr.bar")
  , ("‚•î","harpoon.tr.stop")
  , ("‚áÉ","harpoon.bl")
  , ("‚•°","harpoon.bl.bar")
  , ("‚•ô","harpoon.bl.stop")
  , ("‚áÇ","harpoon.br")
  , ("‚•ù","harpoon.br.bar")
  , ("‚•ï","harpoon.br.stop")
  , ("‚•é","harpoon.lt.rt")
  , ("‚•ê","harpoon.lb.rb")
  , ("‚•ã","harpoon.lb.rt")
  , ("‚•ä","harpoon.lt.rb")
  , ("‚•ë","harpoon.tl.bl")
  , ("‚•è","harpoon.tr.br")
  , ("‚•ç","harpoon.tl.br")
  , ("‚•å","harpoon.tr.bl")
  , ("‚•§","harpoons.rtrb")
  , ("‚••","harpoons.blbr")
  , ("‚•Ø","harpoons.bltr")
  , ("‚•ß","harpoons.lbrb")
  , ("‚•¢","harpoons.ltlb")
  , ("‚áã","harpoons.ltrb")
  , ("‚•¶","harpoons.ltrt")
  , ("‚•©","harpoons.rblb")
  , ("‚áå","harpoons.rtlb")
  , ("‚•®","harpoons.rtlt")
  , ("‚•Æ","harpoons.tlbr")
  , ("‚•£","harpoons.tltr")
  , ("#","hash")
  , ("^","hat")
  , ("‚¨°","hexa.stroked")
  , ("‚¨¢","hexa.filled")
  , ("‚Äê","hyph")
  , ("-","hyph.minus")
  , ("‚Äë","hyph.nobreak")
  , ("‚Äß","hyph.point")
  , ("\173","hyph.soft")
  , ("‚â°","ident")
  , ("‚â¢","ident.not")
  , ("‚â£","ident.strict")
  , ("‚àà","in")
  , ("‚àâ","in.not")
  , ("‚àã","in.rev")
  , ("‚àå","in.rev.not")
  , ("‚àç","in.rev.small")
  , ("‚àä","in.small")
  , ("‚àû","infinity")
  , ("‚à´","integral")
  , ("‚®ó","integral.arrow.hook")
  , ("‚®ë","integral.ccw")
  , ("‚àÆ","integral.cont")
  , ("‚à≥","integral.cont.ccw")
  , ("‚à≤","integral.cont.cw")
  , ("‚à±","integral.cw")
  , ("‚à¨","integral.double")
  , ("‚®å","integral.quad")
  , ("‚®ô","integral.sect")
  , ("‚®ñ","integral.sq")
  , ("‚àØ","integral.surf")
  , ("‚®ò","integral.times")
  , ("‚à≠","integral.triple")
  , ("‚®ö","integral.union")
  , ("‚à∞","integral.vol")
  , ("‚ÄΩ","interrobang")
  , ("Œπ","iota")
  , ("‚®ù","join")
  , ("‚üñ","join.r")
  , ("‚üï","join.l")
  , ("‚üó","join.l.r")
  , ("œó","kai")
  , ("Œ∫","kappa")
  , ("œ∞","kappa.alt")
  , ("‚Ñ™","kelvin")
  , ("Œª","lambda")
  , ("‚Ç∫","lira")
  , ("‚óä","lozenge.stroked")
  , ("‚¨´","lozenge.stroked.small")
  , ("‚¨®","lozenge.stroked.medium")
  , ("‚ß´","lozenge.filled")
  , ("‚¨™","lozenge.filled.small")
  , ("‚¨ß","lozenge.filled.medium")
  , ("<","lt")
  , ("‚ßÄ","lt.circle")
  , ("‚ãñ","lt.dot")
  , ("‚â™","lt.double")
  , ("‚â§","lt.eq")
  , ("‚ãö","lt.eq.gt")
  , ("‚â∞","lt.eq.not")
  , ("‚â¶","lt.eqq")
  , ("‚â∂","lt.gt")
  , ("‚â∏","lt.gt.not")
  , ("‚â®","lt.neqq")
  , ("‚âÆ","lt.not")
  , ("‚ã¶","lt.ntilde")
  , ("Ôπ§","lt.small")
  , ("‚â≤","lt.tilde")
  , ("‚â¥","lt.tilde.not")
  , ("‚ãò","lt.triple")
  , ("‚´∑","lt.triple.nested")
  , ("¬Ø","macron")
  , ("‚ú†","maltese")
  , ("‚àí","minus")
  , ("‚äñ","minus.circle")
  , ("‚à∏","minus.dot")
  , ("‚àì","minus.plus")
  , ("‚äü","minus.square")
  , ("‚âÇ","minus.tilde")
  , ("‚®∫","minus.triangle")
  , ("‚äß","models")
  , ("Œº","mu")
  , ("‚ä∏","multimap")
  , ("‚àá","nabla")
  , ("¬¨","not")
  , ("üéú","notes.up")
  , ("üéù","notes.down")
  , ("‚àÖ","nothing")
  , ("‚¶∞","nothing.rev")
  , ("ŒΩ","nu")
  , ("‚Ñ¶","ohm")
  , ("‚Ñß","ohm.inv")
  , ("œâ","omega")
  , ("Œø","omicron")
  , ("‚àû","oo")
  , ("‚à®","or")
  , ("‚ãÅ","or.big")
  , ("‚ãé","or.curly")
  , ("‚üá","or.dot")
  , ("‚©î","or.double")
  , ("‚à•","parallel")
  , ("‚¶∑","parallel.circle")
  , ("‚à¶","parallel.not")
  , ("(","paren.l")
  , (")","paren.r")
  , ("‚èú","paren.t")
  , ("‚èù","paren.b")
  , ("‚¨†","penta.stroked")
  , ("‚¨ü","penta.filled")
  , ("%","percent")
  , ("‚Ä∞","permille")
  , ("‚üÇ","perp")
  , ("‚¶π","perp.circle")
  , ("‚Ç±","peso")
  , ("œÜ","phi")
  , ("œï","phi.alt")
  , ("œÄ","pi")
  , ("œñ","pi.alt")
  , ("¬∂","pilcrow")
  , ("‚Åã","pilcrow.rev")
  , ("‚Ñé","planck")
  , ("‚Ñè","planck.reduce")
  , ("+","plus")
  , ("‚äï","plus.circle")
  , ("‚ü¥","plus.circle.arrow")
  , ("‚®Å","plus.circle.big")
  , ("‚àî","plus.dot")
  , ("¬±","plus.minus")
  , ("Ôπ¢","plus.small")
  , ("‚äû","plus.square")
  , ("‚®π","plus.triangle")
  , ("¬£","pound")
  , ("‚â∫","prec")
  , ("‚™∑","prec.approx")
  , ("‚™ª","prec.double")
  , ("‚âº","prec.eq")
  , ("‚ã†","prec.eq.not")
  , ("‚™≥","prec.eqq")
  , ("‚™π","prec.napprox")
  , ("‚™µ","prec.neqq")
  , ("‚äÄ","prec.not")
  , ("‚ã®","prec.ntilde")
  , ("‚âæ","prec.tilde")
  , ("‚Ä≤","prime")
  , ("‚Äµ","prime.rev")
  , ("‚Ä≥","prime.double")
  , ("‚Ä∂","prime.double.rev")
  , ("‚Ä¥","prime.triple")
  , ("‚Ä∑","prime.triple.rev")
  , ("‚Åó","prime.quad")
  , ("‚àè","product")
  , ("‚àê","product.co")
  , ("‚àù","prop")
  , ("œà","psi")
  , ("‚àé","qed")
  , ("?","quest")
  , ("‚Åá","quest.double")
  , ("‚Åà","quest.excl")
  , ("¬ø","quest.inv")
  , ("\"","quote.double")
  , ("'","quote.single")
  , ("‚Äú","quote.l.double")
  , ("‚Äò","quote.l.single")
  , ("‚Äù","quote.r.double")
  , ("‚Äô","quote.r.single")
  , ("¬´","quote.angle.l.double")
  , ("‚Äπ","quote.angle.l.single")
  , ("¬ª","quote.angle.r.double")
  , ("‚Ä∫","quote.angle.r.single")
  , ("‚Äü","quote.high.double")
  , ("‚Äõ","quote.high.single")
  , ("‚Äû","quote.low.double")
  , ("‚Äö","quote.low.single")
  , ("‚à∂","ratio")
  , ("‚ñ≠","rect.stroked.h")
  , ("‚ñØ","rect.stroked.v")
  , ("‚ñ¨","rect.filled.h")
  , ("‚ñÆ","rect.filled.v")
  , ("‚Äª","refmark")
  , ("œÅ","rho")
  , ("œ±","rho.alt")
  , ("‚ÇΩ","ruble")
  , ("‚Çπ","rupee")
  , ("‚à©","sect")
  , ("‚©Ñ","sect.and")
  , ("‚ãÇ","sect.big")
  , ("‚©Ä","sect.dot")
  , ("‚ãí","sect.double")
  , ("‚äì","sect.sq")
  , ("‚®Ö","sect.sq.big")
  , ("‚©é","sect.sq.double")
  , ("¬ß","section")
  , (";","semi")
  , ("‚Åè","semi.rev")
  , ("‚Ñ†","servicemark")
  , ("◊©","shin")
  , ("œÉ","sigma")
  , ("/","slash")
  , ("‚´Ω","slash.double")
  , ("‚´ª","slash.triple")
  , ("‚®≥","smash")
  , ("s","space")
  , ("¬†","space.nobreak")
  , ("‚ÄÇ","space.en")
  , ("‚ÄÉ","space.quad")
  , ("‚ÄÑ","space.third")
  , ("‚ÄÖ","space.quarter")
  , ("‚ÄÜ","space.sixth")
  , ("‚Åü","space.med")
  , ("‚Äá","space.fig")
  , ("‚Äà","space.punct")
  , ("‚Äâ","space.thin")
  , ("‚Ää","space.hair")
  , ("‚ñ°","square.stroked")
  , ("‚ñ´","square.stroked.tiny")
  , ("‚óΩ","square.stroked.small")
  , ("‚óª","square.stroked.medium")
  , ("‚¨ú","square.stroked.big")
  , ("‚¨ö","square.stroked.dotted")
  , ("‚ñ¢","square.stroked.rounded")
  , ("‚ñ†","square.filled")
  , ("‚ñ™","square.filled.tiny")
  , ("‚óæ","square.filled.small")
  , ("‚óº","square.filled.medium")
  , ("‚¨õ","square.filled.big")
  , ("‚ãÜ","star.op")
  , ("‚òÖ","star.stroked")
  , ("‚òÖ","star.filled")
  , ("‚äÇ","subset")
  , ("‚™Ω","subset.dot")
  , ("‚ãê","subset.double")
  , ("‚äÜ","subset.eq")
  , ("‚äà","subset.eq.not")
  , ("‚äë","subset.eq.sq")
  , ("‚ã¢","subset.eq.sq.not")
  , ("‚ää","subset.neq")
  , ("‚äÑ","subset.not")
  , ("‚äè","subset.sq")
  , ("‚ã§","subset.sq.neq")
  , ("‚âª","succ")
  , ("‚™∏","succ.approx")
  , ("‚™º","succ.double")
  , ("‚âΩ","succ.eq")
  , ("‚ã°","succ.eq.not")
  , ("‚™¥","succ.eqq")
  , ("‚™∫","succ.napprox")
  , ("‚™∂","succ.neqq")
  , ("‚äÅ","succ.not")
  , ("‚ã©","succ.ntilde")
  , ("‚âø","succ.tilde")
  , ("‚ô£","suit.club")
  , ("‚ô¶","suit.diamond")
  , ("‚ô•","suit.heart")
  , ("‚ô†","suit.spade")
  , ("‚àë","sum")
  , ("‚®ã","sum.integral")
  , ("‚äÉ","supset")
  , ("‚™æ","supset.dot")
  , ("‚ãë","supset.double")
  , ("‚äá","supset.eq")
  , ("‚äâ","supset.eq.not")
  , ("‚äí","supset.eq.sq")
  , ("‚ã£","supset.eq.sq.not")
  , ("‚äã","supset.neq")
  , ("‚äÖ","supset.not")
  , ("‚äê","supset.sq")
  , ("‚ã•","supset.sq.neq")
  , ("‚ä¢","tack.r")
  , ("‚üù","tack.r.long")
  , ("‚ä£","tack.l")
  , ("‚üû","tack.l.long")
  , ("‚´û","tack.l.short")
  , ("‚ä•","tack.t")
  , ("‚üò","tack.t.big")
  , ("‚´´","tack.t.double")
  , ("‚´†","tack.t.short")
  , ("‚ä§","tack.b")
  , ("‚üô","tack.b.big")
  , ("‚´™","tack.b.double")
  , ("‚´ü","tack.b.short")
  , ("‚üõ","tack.l.r")
  , ("œÑ","tau")
  , ("‚à¥","therefore")
  , ("Œ∏","theta")
  , ("œë","theta.alt")
  , ("~","tilde")
  , ("‚àº","tilde.op")
  , ("‚âÉ","tilde.eq")
  , ("‚âÑ","tilde.eq.not")
  , ("‚ãç","tilde.eq.rev")
  , ("‚âÖ","tilde.eqq")
  , ("‚âá","tilde.eqq.not")
  , ("‚âÜ","tilde.neqq")
  , ("‚âÅ","tilde.not")
  , ("‚àΩ","tilde.rev")
  , ("‚âå","tilde.rev.eqq")
  , ("‚âã","tilde.triple")
  , ("√ó","times")
  , ("‚®â","times.big")
  , ("‚äó","times.circle")
  , ("‚®Ç","times.circle.big")
  , ("‚ãá","times.div")
  , ("‚ãã","times.l")
  , ("‚ãå","times.r")
  , ("‚ä†","times.square")
  , ("‚®ª","times.triangle")
  , ("‚ä§","top")
  , ("‚ñ∑","triangle.stroked.r")
  , ("‚óÅ","triangle.stroked.l")
  , ("‚ñ≥","triangle.stroked.t")
  , ("‚ñΩ","triangle.stroked.b")
  , ("‚ó∫","triangle.stroked.bl")
  , ("‚óø","triangle.stroked.br")
  , ("‚ó∏","triangle.stroked.tl")
  , ("‚óπ","triangle.stroked.tr")
  , ("‚ñπ","triangle.stroked.small.r")
  , ("‚ñø","triangle.stroked.small.b")
  , ("‚óÉ","triangle.stroked.small.l")
  , ("‚ñµ","triangle.stroked.small.t")
  , ("üõÜ","triangle.stroked.rounded")
  , ("‚üÅ","triangle.stroked.nested")
  , ("‚ó¨","triangle.stroked.dot")
  , ("‚ñ∂","triangle.filled.r")
  , ("‚óÄ","triangle.filled.l")
  , ("‚ñ≤","triangle.filled.t")
  , ("‚ñº","triangle.filled.b")
  , ("‚ó£","triangle.filled.bl")
  , ("‚ó¢","triangle.filled.br")
  , ("‚ó§","triangle.filled.tl")
  , ("‚ó•","triangle.filled.tr")
  , ("‚ñ∏","triangle.filled.small.r")
  , ("‚ñæ","triangle.filled.small.b")
  , ("‚óÇ","triangle.filled.small.l")
  , ("‚ñ¥","triangle.filled.small.t")
  , ("„Äî","turtle.l")
  , ("„Äï","turtle.r")
  , ("‚è†","turtle.t")
  , ("‚è°","turtle.b")
  , ("‚à™","union")
  , ("‚äå","union.arrow")
  , ("‚ãÉ","union.big")
  , ("‚äç","union.dot")
  , ("‚®É","union.dot.big")
  , ("‚ãì","union.double")
  , ("‚©Å","union.minus")
  , ("‚©Ö","union.or")
  , ("‚äé","union.plus")
  , ("‚®Ñ","union.plus.big")
  , ("‚äî","union.sq")
  , ("‚®Ü","union.sq.big")
  , ("‚©è","union.sq.double")
  , ("œÖ","upsilon")
  , ("‚àñ","without")
  , ("\8288","wj")
  , ("‚Ç©","won")
  , ("‚âÄ","wreath")
  , ("Œæ","xi")
  , ("¬•","yen")
  , ("Œ∂","zeta")
  , ("\8205","zwj")
  , ("\8204","zwnj")
  , ("\8203","zws") ]
